<%- include('../includes/head.ejs') %>
<form method="GET" action="/property" class="form-inline">
  <div class="sidebar-widget advanced-search">
      <h3 class="sidebar-title">Search Properties</h3>

      <!-- Keyword Search -->
      <div class="form-group">
          <input 
              type="text" 
              name="keyword" 
              class="form-control" 
              placeholder="Search by keyword"
              value="<%= typeof keyword !== 'undefined' ? keyword : '' %>"
          />
      </div>

      <!-- City Dropdown -->
      <div class="form-group">
          <select class="form-control" name="cityId">
              <option value="">City</option>
              <% if (cities && cities.length > 0) { %>
                  <% cities.forEach(city => { %>
                      <option value="<%= city.id %>" 
                          <%= cityId == city.id ? 'selected' : '' %> >
                          <%= city.name %>
                      </option>
                  <% }) %>
              <% } %>
          </select>
      </div>

      <!-- Status Dropdown -->
      <div class="form-group">
          <select class="form-control" name="status">
              <option value="">Property Status</option>
              <% if (status && status.length > 0) { %>
                  <% status.forEach(status => { %>
                      <option value="<%= status._id %>" 
                          <%= status == 'status' ? 'selected' : '' %>> 
                          <%= status.name %>
                      </option>
                  <% }) %>
              <% } %>
          </select>
      </div>

      <!-- Price Range Slider -->
      <div class="form-group">
          <label>Price Range ($)</label>
          <input id="price-range" class="form-control" type="text" data-slider-min="<%= priceRange.minPrice %>" data-slider-max="<%= priceRange.maxPrice %>" data-slider-step="1000" data-slider-value="[5000,600000]" />
          <input type="hidden" name="priceRange" id="priceRangeInput" value="<%= typeof priceRange !== 'undefined' ? priceRange : '' %>"/>
      </div>

      <!-- Area Range Slider -->
      <div class="form-group">
          <label>Area Range (sq ft)</label>
          <input id="property-geo" class="form-control" type="text" data-slider-min="<%= areaRange.minArea %>" data-slider-max="<%= areaRange.maxArea %>" data-slider-step="10" data-slider-value="[50,5000]" />
          <input type="hidden" name="areaRange" id="areaRangeInput" value="<%= typeof areaRange !== 'undefined' ? areaRange : '' %>"/>
      </div>

      <!-- Min Baths Slider -->
      <div class="form-group">
          <label>Min Baths</label>
          <input id="min-baths" class="form-control" type="text" data-slider-min="0" data-slider-max="10" data-slider-step="1" data-slider-value="2" />
          <input type="hidden" name="minBaths" id="minBathsInput" value="<%= typeof minBaths !== 'undefined' ? minBaths : '' %>"/>
      </div>

      <!-- Min Beds Slider -->
      <div class="form-group">
          <label>Min Beds</label>
          <input id="min-bed" class="form-control" type="text" data-slider-min="0" data-slider-max="10" data-slider-step="1" data-slider-value="2" />
          <input type="hidden" name="minBeds" id="minBedsInput" value="<%= typeof minBeds !== 'undefined' ? minBeds : '' %>"/>
      </div>

      <!-- Features (checkboxes) -->
      <div class="form-group">
          <label>Features</label><br/>
          <% const selectedFeatures = Array.isArray(features) ? features : []; %>
          <% if (propertyFeatures && propertyFeatures.length > 0) { %>
              <% propertyFeatures.forEach(feature => { %>
                  <label>
                      <input type="checkbox" name="features" value="<%= feature.name %>" 
                      <%= selectedFeatures.includes(feature.name) ? 'checked' : '' %>> 
                      <%= feature.name %>
                  </label><br/>
              <% }) %>
          <% } %>
      </div>

      <!-- Submit Button -->
      <div class="col-md-12 text-center mt-3">
          <button type="submit" class="btn btn-primary w-100">Search</button>
      </div>
  </div>
</form>
